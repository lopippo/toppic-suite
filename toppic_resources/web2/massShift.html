<!DOCTYPE html>
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Protein-Spectrum-Match for Spectrum</title>
<link rel="stylesheet" type="text/css" href="resources/css_lib/jquery.dataTables.css">
<link rel="stylesheet" type="text/css" href="resources/css/prsm.css">
<link rel="stylesheet" type="text/css" href="resources/css_lib/bootstrap.min.css">
<script src="resources/js_lib/jQuery_3_4.js"></script>
<script src="resources/js_lib/Bootstrap/bootstrap.min.js"></script>
<script src="http://d3js.org/d3.v4.min.js"></script>
<script src="resources/js_lib/canvas-toBlob.js"></script>
<script src="resources/js_lib/jquery.dataTables.js"></script>
<script src="resources/js/util/coordinates_util.js"></script>
<script src="resources/js/prsm/prsmtohtml.js"></script>
<script src="resources/js/util/prsmDataUtil.js"></script>
<script src="resources/js/prsm/buttons.js"></script>
<script src="resources/js/Monoisotopic_mass/drawMassShiftSvg.js"></script>
<script src="resources/js/Monoisotopic_mass/aminoAcid.js"></script>
<script src="resources/js/Monoisotopic_mass/theoreticalMass.js"></script>
<script>
var head= document.getElementsByTagName('head')[0];
var script= document.createElement('script');
/* Get the URL from the browser */
var x = location.href;
/* get the proteoform Id number by splitting url with "?","=","#"  */
var l_split = x.split(/[?#]+/);
var prsm_seq_num = l_split[1].split("=");
var file_name = "data_js/prsms/prsm" + prsm_seq_num[1]+".js";
script.type= 'text/javascript';
script.src= file_name;
var loadprsm = false ;
/* Add data file as script to the html */
head.appendChild(script);
/* SVG Id of the HTML */
var id = "l_svg" ;
var script_prsm = document.createElement('script');
script_prsm.type= 'text/javascript';
script_prsm.src = "resources/js/prsm/prsm.js" ;
var spec_id = null ;
/* Call the functions onload of the data */
script.onload = function () {
	/* Loading prsm.js after data is loaded to fix no data issue in Data table */
	head.appendChild(script_prsm);
	
	//BuildUrl();
	//loadDatafromJson2Html();
	para =new parameters();
	let prsm = prsm_data.prsm ;
	/* spec_id = prsm.ms.ms_header.ids ; */
	
	[para,id] = buildSvg(para,prsm,id);
	/*	Color the background of occurence of mass shift */
	massShiftBackgroundColor(para,prsm,id);
	
	drawAcidonSVG(para,prsm,id);
	/*	Get the amount of skipped acid and write the amount 
	 * 	of skipped acid at the start and end of the sequence 
	 */
	skippedAcidNotification(para,prsm,id) ;
	//buildResidueAcids(para,prsm,id);
	if(para.show_num)
	{
		/*	Get the numerical count at the start and end of 
		 * 	each row of sequence */
		getNumValues(para,prsm,id);
	}
	
	/*	Determine the start and end position of the sequence */
	drawAnnoOfStartEndPosition(para,prsm,id) ;
	/*	Draw Annotations */
	annotations(para,prsm,id);
	/*	Get the position of the fixed ptms and color them to red */
	addColorToFixedPtms(para,prsm,id);
	/* 	Onclick actions to save open pop up window and to save SVG as PNG/SVG */
	buttonsAndAlerts(para,prsm,id); 
	/* 	Get occurence ptms */
	occurence_ptm(prsm);
	/* Create peaks data into table content */
	createTableElements();
	/* New Changes */
 	//TheoreticalMass();
 	peakCalData(prsm);
 	//buttons();
};
</script>
</head>
<body>
<div class="container">
<br><br>
<div id="alignment" >
<svg id = "l_svg" ></svg>
<br>
<table>
<tr>
	<td width = "100%">
		<div id="ptm_abbreviation" style="font-size:16px;">
		<!-- Data will be retrieved form Fixed_PTM()   -->
		</div>
	<td>
</tr>
</table>
<br>
</div>
<table>
<tr>
	<td width = "100%">
		<div class = "peaks" style="font-size:16px;">
		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a id = "all_peak_count" href="#spectrum" onclick="showAllPeaks();"  >All peaks </a>
		&nbsp;&nbsp;<a id = "matched_peak_count" href="#spectrum" onclick="showMatchedPeaks();">Matched peaks </a>
		&nbsp;&nbsp;<a id = "not_matched_peak_count" href="#spectrum" onclick="showNotMatchedPeaks();">Not matched peaks </a>
		</div>
	<td>
	<!-- <td width = "20%" align = "right">
		<a id = "a_show_spectrum" href="#spectrum"><button type ="button"  id = "show_spectrum" class="btn btn-primary btn-sm">Show Spectrum</button></a>
	</td> -->
</tr>
</table>
<table id="spectrum" class="display" >
<thead>
<tr role="row">
	<th width="25">Scan</th><th width="25">Peak</th><th width="90">Mono mass</th><th width="90">Mono m/z</th><th width="80" style="vertical-align:middle">Intensity</th><th width="75" style="vertical-align:middle">Charge</th><th width="103">Theoretical mass</th><th width="50" style="vertical-align:middle">Ion</th><th width="70" style="vertical-align:middle">Pos</th><th width="95">Mass error</th><th width="80">PPM error</th>
</tr>
</thead>
</table>
<p style="font-size:15px;">
<a href="proteins.html">All proteins</a> /
      <a id = "protien_url_end" href = ""></a> / 
       <a id= "proteoform_url_end" href=""></a>
</p>
</div>
</body>
</html>